一、背景与总结
1.既然传说中限制是65536，那服务器如何应对百万并发的。
常规误区是65536是端口数，但一个端口可以支持不同ip的请求，因此端口数不代表能接收的并发数。

二、基础知识介绍
1.客户端与服务器的唯一标识
一台服务器对外开放后，所有客户端都可以访问，那如何识别是唯一ID呢，这样服务端接到信息后就可以知道谁应该处理了，所以唯一ID很重要。
唯一标识5要素<客户端ip,客户端端口,服务端ip,服务端端口,服务协议>

2.客户端最多可以并发多少个链接
客户端要与服务器建立连接，需要提供本地的ip+端口+协议是唯一的。
客户端ip是固定的，端口是short 16位类型，因此最多提供65536个。
抛开协议不说，假设协议也是固定的，是tcp协议。

因此最多客户端可以并发请求65536个不同的服务器。

3.服务端最大tcp连接数
服务端ip、服务端端口是固定的。
客户端ip是32位，因此可以提供2^32次方ip。
客户端端口是16位，因此一个客户端可以提供2^16 = 65536个请求。(即客户端把所有端口都占用，发给同一个服务)
协议固定时， 服务端最多可以接受2^48次方请求，非常大。

即同一个客户端，不同端口都可以发请求。
客户端2.2.2.2:5555可以发一个请求；
客户端2.2.2.2:6666也可以发一个请求；

4.实际服务端可接受连接数
a.受服务器资源限制。
每一个连接要有单独的内存、文件描述符(每一个sockt就是一个文件描述符)
服务端通过增加内存、修改最大文件描述符等参数，单机支持最大并发10万或者100万是没有问题的。

b.受服务器硬件、软件架构的影响。

即：常规误区是65536是端口数，但一个端口可以支持不同ip的请求，因此端口数不代表能接收的并发数。

三、accept的意义
tcp的accept就是在匹配 客户端+端口+协议是否已经接收过了：

a.如果接收过了，直接返回对应的socket即可；
b.如果没有接收过，则创建内存、socket文件句柄，并且初始化即可。