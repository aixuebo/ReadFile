一、命令
1.常用命令
du -sh
du -sh *
df -h
df –lh 查看磁盘信息

2.命令全名
du-Disk Usage
df-Disk Free


二、出现的问题,df查看磁盘空间达到100%,但是du却没有那么多,但是真实情况是确实不能写入磁盘任何内容了
1.原因是写入磁盘内容是参考df的,即创建一个文件,向里面写入数据是依赖df的,当df为100%的时候会不能被写入文件了。
2.df和du差距很大的原因,是统计的原理不一样,后面详细介绍
3.解决du和df统计结果差距的问题,是使用lsof命令,查看系统文件使用情况,将一些已经删除的文件,却被某些进程持有,将该进程kill掉即可。

三、df和du的原理
3.1 du的工作原理
du命令会对待统计文件逐个调用fstat这个系统调用，获取文件大小。
它的数据是基于文件获取的，所以有很大的灵活性，不一定非要针对一个分区，可以跨越多个分区操作。如果针对的目录中文件很多，du速度就会很慢了。
3.2 df的工作原理
df命令使用的事statfs这个系统调用，直接读取分区的超级块信息获取分区使用情况。
它的数据是基于分区元数据的，所以只能针对整个分区。由于df直接读取超级块，所以运行速度不受文件多少影响。

问题原因
1.常见的df和du不一致情况就是文件删除的问题。当一个文件被删除后，在文件系统 目录中已经不可见了，所以du就不会再统计它了。
然而如果此时还有运行的进程持有这个已经被删除了的文件的句柄，那么这个文件就不会真正在磁盘中被删除， 分区超级块中的信息也就不会更改。这样df仍旧会统计这个被删除了的文件。
2.另一个表现出du与df命令不同之处的例子如下：
如果用户删除了一个正在运行的应用所打开的某个目录下的文件，则du命令返回的值显示出减去了该文件后的目录的大小。但df命令并不显示减去该文件后的大小。直到该运行的应用关闭了这个打开的文件，df返回的值才显示出减去了该文件后的文件系统的使用情况。


四、磁盘报警,如何发现哪个文件夹引起的
1.df –lh 查看整体磁盘,看哪个目录出的问题
2.进入出问题目录,计算当前目录文件夹大小
du -h --max-depth=1 寻找当前目录，哪个文件夹占用空间最大
如果报权限问题,则du -h --max-depth=1 >aaa.txt ,最后去aaa.txt看数据
3.依次进入最大文件夹
4.删除大文件 rm –f catalina.out
但此时df –lh发现磁盘还是没有变化,原因:
在Linux或者Unix系统中，通过rm或者文件管理器删除文件将会从文件系统的目录结构上解除链接(unlink).
然而如果文件是被打开的（有一个进程正在使用），那么进程将仍然可以读取该文件，磁盘空间也一直被占用。

输入命令：/usr/sbin/lsof|grep deleted 确认删除文件是否被占用
找到delete的文件进程ID,kill -9 13117
再次输入命令：df –lh 空间被释放了
