一、明细层
基于事实表，left join等操作后,创建只有维度+指标的数据表。

二、汇总层
基于明细层模型,对数据进行group by 维度 + 指标汇总，输出结果。

三、问题
1.维度分绝对维度 + 维度属性。
比如valid有效性、商家地址等信息就是维度属性。
当维度表跨多dt查询汇总指标时，如果需要维度属性信息，可能会存在问题。
a.因为维度属性参与max、min时，多个维度属性不能保证是归属到同一行数据。
b.维度属性用于group by操作,则跨天后,同一个维度id下维度属性可能是不同的值,造成1对多case。

解决方案:
a.当真实需要维度属性展示时，要单独关联维度表,获取维度属性在某一天/或者最新值即可。
b.当使用valid维度属性聚合时，考虑的是是否有效，因此也是可以参与聚合的。
所以维度属性能否参与聚合,需要使用模型的时候，应用方自己评估。
因此下游理解不透彻的话,可能会造成bug问题。
