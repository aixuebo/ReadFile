一、日志系统
让每一个业务系统规划相同的日志格式,是很难的,因此要先规划一个日志模板,或者 日志系统,业务日志直接发送数据到系统 或者 使用模板即可

二、基于规则的spark实时系统
1.web页面配置各种规则
比如最简单的配置一套正则表达式规则
2.通过外部一个规则页面配置过则,spark streaming系统单位时间内去处理一个时间窗口的数据
将数据对应每一个规则进行处理,处理结果存储到redis中。
此时redis的key是基于规则的ID以及规则时间窗口的基础时间设置的
3.另外系统读取redis的内容,并且处理----总之处理redis的数据sink到其他地方去
a.将其sink到mysql用于BI展示
b,sink到kafka队列,让其他平台消费
c.sink到报警平台,去发送报警信息

三、报警平台
根据规则的值,可以设置很多报警,不同的伐值报警产生的不同的报警平台，比如短信、叮叮、邮件、微信等

四、规则的可能性
1.基于正则表达式的规则,统计出现的次数
缺点是解析速度会慢
2.提供基于文本的List规则集合,以及规则,比如 要包含aaa,也要包含bbb,但是不包含ccc的,则规则集合是and aaa and bbb and ! ccc 这样的一组字符串集合,这样字符串匹配性能会很高
或者再更高级的方式是自己解析规则,用户添加的字符串就是(aaa && bbb ) && !ccc
3.比如每一次都会记录sql的执行时间,或者request的时间,因此可以统计平均延迟时间,或者基于规则的超出一定时间则报警
4.pv、uv的统计
此时涉及到同一个key的过滤重复问题,以及如何提取出key的值的问题
