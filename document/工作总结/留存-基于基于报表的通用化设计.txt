
一、背景:
假设每周统计活跃用户数、留存用户数、留存率。输出临时表schema如下:


周号              delta周         base用户数      delta周活跃用户数   留存用户数、留存率(留存用户数/base用户数)
周开始-周结束   	0周	             1000		    1000               400       40%
周开始-周结束   	1周	             1000		    500                400       40%


注意:
1.delta周为0时，表示基准周，即base用户数与delta用户数相同
周 、delta周、用户基数、留存用户数、留存用户总实付交易额、留存用户总订单量


二、这样输出的报表按照标准的行展示，结果如上，可以知道每一周的4个指标，但需求上往往是希望相同周号的数据汇总在一行。
即提供两个字段作为维度，其他字段都是指标。两个维度一个做为行、一个做为列。

即
周号           1周                              										   2周
              base用户数      delta周活跃用户数   留存用户数、留存率(留存用户数/base用户数)		 base用户数      delta周活跃用户数   留存用户数、留存率(留存用户数/base用户数)
 
三、          
因此在数据表不变的情况下，如何实现？通过前端去实现。告诉前端2个字段，一个字段表示行(周号)，一个字段表示列(delta周)。
这样遇到周号发生变化的时候，新启动一行；相同周号下，每一个字段都顺序以列的形式，落盘即可。

四、参考资料
参见:留存列展示报表形式.png
