一、wholeTextFiles
val rdd1 = sc.wholeTextFiles("/log/statistics/etl/test_invite",5) //用5个分区读取一个输入路径,输出是key-value,key是文件路径,value是文件全部内容,包括回车换行等信息
rdd1.foreach(println)
输出
(hdfs://ip:port/log/statistics/etl/test_invite/temp_invite_2.txt,1,2
1,3
2,4
3,5
4,6
7,8
7,9
2,10
)
(hdfs://ip:port/log/statistics/etl/test_invite/xxx.txt,inde
adsada
index
wowow
)

二、RDD各种转换

val inputPath = "/log/r/test/xxxx.csv"
val outputPath = "/log/r/test_output2/xxxx.csv"

val dataRDD = sc.textFile(inputPath)
1.将一行数据转换成元组(userid,line)
2.对元组进行group by userid分组
3.对分组的内容获取
4.存储最终分组内容
pipeRDD.saveAsTextFile(outputPath)
val pipeRDD = dataRDD.map{line =>
 (line.split(",")(0),line)
}.groupByKey().flatMap(_._2)
pipeRDD.saveAsTextFile(outputPath)

拿到前20条数据,获取Array数组,然后打印数据内容
val xxx = pipeRDD.take(20)
for(x <- xxx) println(x)

pipeRDD.collect() 拿回全部数据


