SparkSQL对两张大表join采用了全新的算法－sort-merge join，整个过程分为三个步骤：

1.shuffle阶段：将两张大表根据join key进行重新分区，两张表数据会分布到整个集群，以便分布式并行处理
2.sort阶段：对单个分区节点的两表数据，分别进行排序
reduce阶段,接受来自两个数据源的信息，因为天然每一个数据源的数据是按照key排序后的文件。
所以只需要merge从所有节点拉去到的数据即可。
3.merge阶段：对排好序的两张分区表数据执行join操作。join操作很简单，分别遍历两个有序序列，碰到相同join key就merge输出，否则继续取更小一边的key。

